<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>AVR 02 - Creación de un proyecto</title>

		<link rel="stylesheet" href="assets/css/reveal.css">
		<link rel="stylesheet" href="assets/css/theme/night.css">

		<link rel="stylesheet" href="assets/css/jquery.treemenu.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="assets/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'assets/css/print/pdf.css' : 'assets/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!-- Estilos para las presentaciones -->
		<link rel="stylesheet" href="assets/css/fredstyle.css">

	</head>
	<body>
		<div class="reveal">
			<div class="slides">

				<!-- INICIO Slide 0 -->
				<section>
					<h2>Programación de Micros <span class="theme-color">AVR</span> en Linux</h2>
					<img width="60%" src="assets/img/linux+avr3.jpg" alt="">
				</section>
				<!-- FIN Slide 0 -->

				<!-- INICIO Slide 1 -->
				<section >
					 <h2>CREACIÓN DE UN PROYECTO</h2>
					<p class="theme-color">Hola Mundo en un AVR</p>
				</section>
				<!-- FIN Slide 1 -->

				<!-- INICIO Slide 2 -->
				<section>
					<h2>Programa APOS</h2>
					<p class="theme-color description">
						APOS es un programa para crear plantillas de proyectos para microcontroladores AVR.
						Su uso es muy sencillo y cuenta con varias opciones para configurar el proyecto
						de acuero al hardware que se utilizará.
					</p>
				</section>
				<!-- FIN Slide 2 -->

				<!-- INICIO Slide 3 -->
				<section>
					<h3>¿Cómo se utiliza?</h3>
					<p class="theme-color description">APOS es un software CLI (Command Line Interface), no tiene interfaz
						gráfica por lo que es necesario utilizar la terminal de Linux.
					</p>
					<p class="theme-color description">Para ver la ayuda del programa se debe ejecutar el comando</p>
					<pre class="bash-command">
						<code class="bash" data-trim data-noescape>
							$ <span style="color:darkseagreen">apos</span> ?
						</code>
					</pre>
				</section>
				<!-- FIN Slide 3 -->

				<!-- INICIO Slide 4 -->
				<section>
					<h3>Creación de un proyecto</h3>
					<p class="theme-color description">
						Para crear un proyecto vacío hay que ejecutar el comando <span class="highlight">apos</span>
						seguido del nombre del proyecto.
					</p>
					<pre class="bash-command">
						<code class="bash" data-trim data-noescape>
							$ <span class="highlight">apos</span> NOMBRE_PROYECTO
						</code>
					</pre>
					<p class="theme-color description">Se creará una carpeta con el nombre NOMBRE_PROYECTO que
						incluye las carpetas <span class="highlight-red">include</span>, <span class="highlight-red">src</span>,
						el archivo <span class="highlight-red">Makefile</span>, el archivo <span class="highlight-red">main.c</span>
						y un archivo <span class="highlight-red">README.md</span>
					</p>

				</section>
				<!-- FIN Slide 4 -->

				<!-- INICIO Slide 5 -->
				<section>
					<h3>Opciones del programa APOS</h3>
					<p class="theme-color description">
						Por default el programa crea un proyecto para el micro <span class="highlight-red">atmega328p</span>
						a una frecuencia de <span class="highlight-red">16 MHz</span> configurado para utilizar el programador <span class="highlight-red">usbtiny</span>
					</p>
					<p class="description medium-text">
						<span class="highlight-cyan">-m</span>: Define el micro AVR a utilizar.
						<br>
						<span class="highlight-cyan">-f</span>: Define la frecuencia de operación.
						<br>
						<span class="highlight-cyan">-p</span>: Define el programador a utilizar.
					</p>
					<pre class="bash-command">
						<code class="bash" data-trim data-noescape>
							$ <span class="highlight">apos</span> <span class="highlight-cyan">-m</span> atemga32 <span class="highlight-cyan">-f</span> 16000000 <span class="highlight-cyan">-p</span> dragon_isp NOMBRE_PROYECTO
						</code>
					</pre>

				</section>
				<!-- FIN Slide 5 -->

				<!-- INICIO Slide 6 -->
				<section>
					<h3>Otras opciones</h3>
					<p class="theme-color description">
						APOS permite otras opciones avanzadas, como la creación de un proyecto con el
						codigo de un programa blink, la inicialización de un repositorio GIT y
						la definición de los fusibles del microcontrolador.
					</p>
					<p class="description medium-text">
						<span class="highlight-cyan">-b</span>: Crea el proyecto con un programa blink de ejemplo.
						<br>
						<span class="highlight-cyan">-g</span>: Inicializa el proyecto con repositorio GIT.
						<br>
						<span class="highlight-cyan">-lf</span>: Define el valor del fusible bajo.
						<br>
						<span class="highlight-cyan">-hf</span>: Define el valor del fusible alto.
						<br>
						<span class="highlight-cyan">-ef</span>: Define el valor del fusible extendido.
					</p>
				</section>
				<!-- FIN Slide 6 -->

				<!-- INICIO Slide 7 -->
				<section>
					<h2>Hola Mundo</h2>
					<p class="theme-color description">
						Crear un proyecto "blink" con el micro atmega32 a una frecuencia de 16Mhz con el comando:
					</p>
					<pre class="bash">
						<code data-trim data-noescape>
							$ <span class="mredium-text highlight">apos</span> <span class="highlight-cyan">-m</span> atemga32 <span class="highlight-cyan">-f</span> 16000000  hola_mundo

							apos: Project "hola_mundo" created!

							Project Information:
						  
							 Project Name:    "hola_mundo"
							 Git Repository:  False
							 Blink Template:  False
							 Microcontroller: atmega328p
							 CPU Frequency:   16000000
							 Low Fuse:        DE
							 High Fuse:       D9
							 Extended Fuse:   FF
							 Programmer:      usbtiny
						  
						</code>
					</pre>
				</p>

			</section>
			<!-- FIN Slide 7 -->

			<!-- INICIO Slide 8 -->
			<section>
				<h3>Estructura del proyecto</h3>
				<p class="theme-color description">

				</p>

				<ul class="tree">
					<li>
						<span style="color:yellow">hola_mundo</span>
						<ul>

							<li>
								<span class="highlight-red">include</span>
								<ul>
									<li class="active">Archivos de cabecera aquí</li>
								</ul>
							</li>
							<li>
								<span class="highlight-red">src</span>
								<ul>
									<li class="active">Archivos de código fuente aquí</li>
								</ul>
								<li class="highlight-cyan">main.c</li>
								<li class="highlight-cyan">Makefile</li>
								<li >README.md</li>
							</ul>
						</li>
					</li>
				</ul>
			</section>
			<!-- FIN Slide 8 -->

			<!-- INICIO Slide 9 -->
		</section>
		<section>
			<h2>Compilación</h2>
			<p class="theme-color description">
				Para compilar el programa se abre la carpeta del proyecto con el editor
				Visual Studio Code desde la terminal:
				<pre class="bash">
					<code style="text-align: center" data-trim>
						$ code hola_mundo
							</code>
						</pre>
					</p>
				</section>

				<section>
					<p class="theme-color description">
						Abrir la terminal integrada de Visual Studio Code en el menú <span class="highlight-cyan">Ver&rarr;Terminal integrado</span>
					</p>
					<p class="theme-color description">
						Escribir el comando <span class="highlight-red">make</span> en la terminal integrada para compilar:
					</p>
					<pre class="bash">
						<code style="text-align: left" data-trim >
								$ make

								AVR Memory Usage
								----------------
								Device: atmega32

								Program:     158 bytes (0.5% Full)
								(.text + .data + .bootloader)

								Data:          0 bytes (0.0% Full)
								(.data + .bss + .noinit)

						</code>
					</pre>
				</section>
				<!-- FIN Slide 9 -->

				<!-- INICIO Slide 10 -->
				<section>
					<h3>Archivo main.c</h3>
					<pre class="cpp">
						<code style="text-align: left" data-trim >
							void AVRInit() {
							    DDBR = 0xFF // Puerto B como salida
							}

							int main() {
							    AVRInit();

							    while(1) // Ciclo Infinito
							    {
							        PORTB = 0xFF;   // Enciende los leds
							        _delay_ms(1000) // Retardo de 1s
							        PORTB = 0;      // Apaga los leds
							        _delay_ms(1000) // Retardo de 1s
							    }
							    return 0;
							}
						</code>
					</pre>
				</section>
				<!-- FIN Slide 10 -->

				<!-- INICIO Slide 11 -->
				<section>
					<h3>Archivo Makefile</h3>
					<pre class="makefile">
						<code style="text-align: left" data-trim >
							PROJECT_NAME = hola_mundo
							DEVICE       = atmega32
							CLOCK        = 16000000
							PROGRAMMER   = -c usbasp -P usb
							FUSES        = -U hfuse:w:0xD9:m -U lfuse:w:0xDE:m #-U efuse:w:0xFF:m
							AVRDUDE      = avrdude $(PROGRAMMER) -p $(DEVICE)

							OBJECT_FILES   = main.o
							#OBJECT_FILES += ./src/mySource.o

							INCLUDEPATHS   = -I ./include
							#INCLUDEPATHS += -I ./include/myFolder
						</code>
					</pre>
				</section>
				<!-- FIN Slide 11 -->

				<!-- INICIO Slide 12 -->
				<section >
					<h2>Siguiente capítulo</h2>
					<h5>Carga del programa en el micro AVR</h5>
					<br>
					<a href="03-carga-programa.html">Ir al capitulo 3</a>
				</section>
				<!-- FIN Slide 12 -->

			</div>
		</div>

		<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
		<script src="assets/js/head.min.js"></script>
		<script src="assets/js/reveal.js"></script>

		<script src="assets/js/jquery.treemenu.js"></script>

		<script>
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				loop: false,
				mouseWheel: true,
				rollingLinks: true,
				theme: Reveal.getQueryHash().theme || 'default',
				dependencies: [
					{ src: 'assets/plugin/markdown/marked.js' },
					{ src: 'assets/plugin/markdown/markdown.js' },
					{ src: 'assets/plugin/notes/notes.js', async: true },
					{ src: 'assets/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
			$(".tree").treemenu({ delay: 100, openActive: true });

		</script>
	</body>
</html>
